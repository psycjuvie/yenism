<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>yenism</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-black text-white font-mono">
    <div class="max-w-4xl mx-auto px-4 py-10">
        <div class="flex items-center justify-between mb-6">
            <div class="text-xl tracking-wide">yenism</div>
            <div class="text-xs opacity-70">titles, lyrics, and tools</div>
        </div>

        <div class="grid gap-4 md:grid-cols-2">
            <div class="rounded-2xl border border-white/20 bg-white/5 p-4">
                <div class="text-xs opacity-70 mb-2">song title</div>
                <input id="title"
                    class="w-full rounded-xl bg-black/60 border border-white/20 px-3 py-2 text-sm outline-none focus:border-white/40"
                    placeholder="type a title or generate one">

                <div class="mt-3 flex flex-wrap items-center gap-2">
                    <select id="title_style"
                        class="rounded-xl bg-black/60 border border-white/20 px-3 py-2 text-sm outline-none focus:border-white/40">
                        <option value="auto">auto</option>
                        <option value="word">word</option>
                        <option value="phrase">phrase</option>
                    </select>
                    <button id="random_title"
                        class="rounded-xl border border-white/20 px-3 py-2 text-sm hover:border-white/40">random song
                        title</button>
                </div>

                <div class="mt-4 text-xs opacity-70 mb-2">extra info</div>
                <textarea id="extra"
                    class="w-full rounded-xl bg-black/60 border border-white/20 px-3 py-2 text-sm outline-none focus:border-white/40 min-h-[80px]"
                    placeholder="optional direction, mood, idea, or constraint"></textarea>

                <div class="mt-3">
                    <button id="generate_lyrics"
                        class="rounded-xl border border-white/20 px-3 py-2 text-sm hover:border-white/40">generate
                        lyrics</button>
                </div>
            </div>

            <div class="rounded-2xl border border-white/20 bg-white/5 p-4">
                <div class="text-xs opacity-70 mb-2">other</div>
                <textarea id="other_q"
                    class="w-full rounded-xl bg-black/60 border border-white/20 px-3 py-2 text-sm outline-none focus:border-white/40 min-h-[180px]"
                    placeholder="ask anything with lyrics attached"></textarea>

                <div class="mt-2 flex gap-2">
                    <button id="other_go"
                        class="rounded-xl border border-white/20 px-3 py-2 text-sm hover:border-white/40">run</button>
                    <button id="clear"
                        class="rounded-xl border border-white/20 px-3 py-2 text-sm hover:border-white/40">clear
                        output</button>
                </div>

                <div id="status" class="mt-4 text-xs opacity-70 min-h-[16px]"></div>
                <pre id="output"
                    class="mt-3 rounded-xl border border-white/20 bg-black/40 p-3 whitespace-pre-wrap leading-relaxed text-sm min-h-[260px]"></pre>
            </div>
        </div>
    </div>

    <script>
        const title = document.getElementById("title")
        const extra = document.getElementById("extra")
        const output = document.getElementById("output")
        const status = document.getElementById("status")
        const title_style = document.getElementById("title_style")
        const other_q = document.getElementById("other_q")

        function set_status(t) {
            status.textContent = (t || "").toLowerCase()
        }

        function set_output(t) {
            output.textContent = t || ""
        }

        document.getElementById("random_title").onclick = async () => {
            set_status("generating title...")
            set_output("")
            const res = await fetch("/title", {
                method: "post",
                headers: { "content-type": "application/json" },
                body: JSON.stringify({ style: title_style.value })
            })
            const data = await res.json()
            title.value = (data.title || "").toLowerCase()
            set_status("title set.")
        }

        document.getElementById("generate_lyrics").onclick = async () => {
            set_status("generating lyrics...")
            set_output("")
            const res = await fetch("/generate", {
                method: "post",
                headers: { "content-type": "application/json" },
                body: JSON.stringify({
                    title: title.value || "",
                    extra: extra.value || ""
                })
            })
            const data = await res.json()
            set_output(data.text || "")
            set_status("done.")
        }

        document.getElementById("other_go").onclick = async () => {
            const q = (other_q.value || "").trim()
            if (!q) return set_status("type something first.")
            set_status("running...")
            set_output("")
            const res = await fetch("/other", {
                method: "post",
                headers: { "content-type": "application/json" },
                body: JSON.stringify({ q })
            })
            const data = await res.json()
            set_output(data.text || "")
            set_status("done.")
        }

        document.getElementById("clear").onclick = () => {
            set_output("")
            set_status("")
        }
    </script>
</body>

</html>